# Load packages.
library(tidyverse)
library(tidymodels)
# Import soup data and select the Sales, Any_Disp_Spend, Any_Feat_Spend, and Any_Price_Decr_Spend variables
set.seed(7)
soup_data <- soup_data |>
mutate(
nonsense_01 = rnorm(nrow(soup_data), mean = 0, sd = 5),
nonsense_02 = rnorm(nrow(soup_data), mean = 50, sd = 10),
nonsense_03 = rnorm(nrow(soup_data), mean = -10, sd = 20),
nonsense_04 = rnorm(nrow(soup_data), mean = 100, sd = 100),
nonsense_05 = runif(nrow(soup_data), min = -5, max = 5),
nonsense_06 = runif(nrow(soup_data), min = 25, max = 500),
nonsense_07 = runif(nrow(soup_data), min = -50, max = 10),
nonsense_08 = rbinom(nrow(soup_data), size = 1, prob = 0.25),
nonsense_09 = rbinom(nrow(soup_data), size = 3, prob = 0.10),
nonsense_10 = rbinom(nrow(soup_data), size = 7, prob = 0.85)
)
soup_data <- read_csv("soup_data.csv")
soup_data <- soup_data |> select(Sales, Any_Disp_Spend, Any_Feat_Spend, Any_Price_Decr_Spend)
set.seed(7)
soup_data <- soup_data |>
mutate(
nonsense_01 = rnorm(nrow(soup_data), mean = 0, sd = 5),
nonsense_02 = rnorm(nrow(soup_data), mean = 50, sd = 10),
nonsense_03 = rnorm(nrow(soup_data), mean = -10, sd = 20),
nonsense_04 = rnorm(nrow(soup_data), mean = 100, sd = 100),
nonsense_05 = runif(nrow(soup_data), min = -5, max = 5),
nonsense_06 = runif(nrow(soup_data), min = 25, max = 500),
nonsense_07 = runif(nrow(soup_data), min = -50, max = 10),
nonsense_08 = rbinom(nrow(soup_data), size = 1, prob = 0.25),
nonsense_09 = rbinom(nrow(soup_data), size = 3, prob = 0.10),
nonsense_10 = rbinom(nrow(soup_data), size = 7, prob = 0.85)
)
# Set the randomization seed.
set.seed(42)
# Split the data.
soup_split <- initial_split(soup_data, prop = 0.90)
soup_split
# Access the training data.
training(soup_split)
# Access the testing data.
testing(soup_split)
# Fit the simple model with training data.
fit_simple <- linear_reg() |>
set_engine("lm") |>
fit(
Sales ~ Any_Disp_Spend + Any_Feat_Spend + Any_Price_Decr_Spend,
data = training(soup_split)
)
# Fit the complex model with training data
fit_complex <- linear_reg() |>
set_engine("lm") |>
fit(
Sales ~ .,
data = training(soup_split)
)
# Compare overall model fit.
bind_rows(
glance(fit_simple),
glance(fit_complex)
)
# Compute predictive fit for simple model
fit_simple |>
predict(new_data = testing(soup_split)) |>
bind_cols(testing(soup_split)) |>
rmse(truth = Sales, estimate = .pred)
# compute predictive fit for complex model
fit_complex |>
predict(new_data = testing(soup_split)) |>
bind_cols(testing(soup_split)) |>
rmse(truth = Sales, estimate = .pred)
# Compute predictive fit for the simple model on the training data (BAD)
fit_simple |>
predict(new_data = training(soup_split)) |>
bind_cols(training(soup_split)) |>
rmse(truth = Sales, estimate = .pred)
# Compute predictive fit for the complex model on the training data (BAD)
fit_complex |>
predict(new_data = training(soup_split)) |>
bind_cols(training(soup_split)) |>
rmse(truth = Sales, estimate = .pred)
ifood <- read_csv("ifood.csv")
ifood <- ifood |>
mutate(total_spend = MntWines + MntFruits + MntMeatProducts + MntFishProducts + MntSweetProducts + MntGoldProds)
